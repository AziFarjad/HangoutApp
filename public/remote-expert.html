
<html>
<head>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/peerjs/0.3.14/peer.min.js"></script>
</head>

<body>
  <button type="button" name="button" onclick="iAmTheFieldWorker()">I am the field worker</button>
  <button type="button" name="button" onclick="iAmTheExpert()">I am the Expert</button>

  <script>
    navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia;

    function iAmTheFieldWorker() {
      var peer = new Peer('remote-export-field-worker', { key: 'vwxqr8i0iwrn3ik9' });

      peer.on('error', function(error) { console.log("eek!", error); });

      peer.on('open', function(id) {
        console.log('Field worker has an id: ' + id);

        peer.on('call', function(){
          console.log("fieldworker recieved call");
        });
      });
    };

    function iAmTheExpert() {
      var peer = new Peer('remote-export-expert', { key: 'vwxqr8i0iwrn3ik9' });

      peer.on('open', function(id) {
        console.log('Expert has an id: ' + id);

      peer.on('error', function(error) { console.log("eeek!", error); });

        navigator.getUserMedia({video: true, audio: true}, function(stream) {
          console.log('success!');
          var call = peer.call('remote-export-field-worker', stream);

        }, function(err) {
          console.log('Failed to get local stream' ,err);
        });

      });
    };
  </script>
</body>
</html>
